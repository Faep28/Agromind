<div class="container">
  <h2>Crear Noticia</h2>
  <form [formGroup]="noticiaForm" (ngSubmit)="onSubmit()">
    <mat-form-field appearance="fill">
      <mat-label>Título</mat-label>
      <input matInput formControlName="titulo" />
      <mat-error *ngIf="noticiaForm.get('titulo')?.invalid">El título es obligatorio.</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Contenido</mat-label>
      <textarea matInput formControlName="contenido"></textarea>
      <mat-error *ngIf="noticiaForm.get('contenido')?.invalid">El contenido es obligatorio.</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill">
  <mat-label>Fecha de Publicación</mat-label>
  <input matInput [matDatepicker]="picker" formControlName="fechapublicacion">
  <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
  <mat-datepicker #picker></mat-datepicker>
  <mat-error *ngIf="noticiaForm.get('fechapublicacion')?.invalid">La fecha es obligatoria.</mat-error>
</mat-form-field>

    

    <div class="file-input">
      <mat-label>Imagen</mat-label>
      <input type="file" (change)="onFileChange($event)" formControlName="imagen" />
      <mat-error *ngIf="noticiaForm.get('imagen')?.invalid">La imagen es obligatoria.</mat-error>
    </div>

    <button mat-raised-button type="submit" [disabled]="noticiaForm.invalid">Crear Noticia</button>
  </form>

  <hr>

  <h3>Noticias Existentes</h3>
<div *ngFor="let noticia of noticias">
  <mat-card>
    <mat-card-header>
      <mat-card-title>{{ noticia.titulo }}</mat-card-title>
      <mat-card-subtitle>{{ noticia.fechapublicacion | date }}</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
      <p>{{ noticia.contenido }}</p>

      <!-- Aquí se muestra la imagen convertida a base64 -->
      <img *ngIf="noticia.imagen" [src]="'data:image/jpeg;base64,' + noticia.imagen" alt="Imagen de la noticia" style="max-width: 100%; height: auto;" />
    </mat-card-content>
    <mat-card-actions>
      <!-- Botón de eliminar -->
      <button mat-button color="warn" (click)="eliminarNoticia(noticia.id)">Eliminar</button>
    </mat-card-actions>
  </mat-card>
</div>
</div>
