<div class="main-content">
    <mat-card class="header-card">
        <mat-card-header>
            <mat-card-title>
                <mat-icon>psychology</mat-icon>
                Sistema de Recomendaciones
            </mat-card-title>
            <mat-card-subtitle>Obtén recomendaciones personalizadas para tus cultivos</mat-card-subtitle>
        </mat-card-header>
    </mat-card>

    <mat-card class="selector-card">
        <mat-card-content>
            <div class="selector-section">
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Seleccione un cultivo</mat-label>
                    <mat-select [(ngModel)]="cultivoSeleccionadoId" [disabled]="isLoading || cultivos.length === 0">
                        <mat-option [value]="null" disabled>-- Seleccione Cultivo --</mat-option>
                        <mat-option *ngFor="let cultivo of cultivos" [value]="cultivo.id">
                            {{ cultivo.nombre }}
                        </mat-option>
                    </mat-select>
                    <mat-icon matPrefix>local_florist</mat-icon>
                    <mat-hint *ngIf="cultivos.length === 0">No tienes cultivos registrados</mat-hint>
                </mat-form-field>
                
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Seleccione el servicio</mat-label>
                    <mat-select [(ngModel)]="servicioSeleccionadoId" [disabled]="isLoading">
                        <mat-option [value]="null" disabled>-- Seleccione Servicio --</mat-option>
                        <mat-option *ngFor="let servicio of serviciosDisponibles" [value]="servicio.id">
                            {{ servicio.nombre }}
                        </mat-option>
                    </mat-select>
                    <mat-icon matPrefix>build</mat-icon>
                </mat-form-field>

                <button mat-raised-button color="primary" 
                        (click)="obtenerRecomendaciones()" 
                        [disabled]="!cultivoSeleccionadoId || !servicioSeleccionadoId || isLoading"
                        class="obtener-btn">
                    <mat-icon>search</mat-icon>
                    Obtener Tareas Recomendadas
                </button>
            </div>

            <mat-progress-bar mode="indeterminate" *ngIf="isLoading"></mat-progress-bar>
            
            <div *ngIf="mensajeError" class="error-message">
                <mat-icon>error</mat-icon>
                {{ mensajeError }}
            </div>
        </mat-card-content>
    </mat-card>
    
    <mat-card class="recomendaciones-card" *ngIf="tareasRecomendadas">
        <mat-card-header>
            <mat-card-title>
                <mat-icon>recommend</mat-icon>
                Recomendación para tu Cultivo
            </mat-card-title>
        </mat-card-header>
        <mat-card-content>
            <div class="tarea-content">
                <mat-icon class="task-icon">task_alt</mat-icon>
                <div class="tarea-texto">{{ tareasRecomendadas }}</div>
            </div>
        </mat-card-content>
    </mat-card>

    <mat-card class="tips-card">
        <mat-card-header>
            <mat-card-title>
                <mat-icon>tips_and_updates</mat-icon>
                Tips para tu cultivo diario
            </mat-card-title>
        </mat-card-header>
        <mat-card-content>
            <div class="tips-container">
                <mat-card class="tip-item">
                    <mat-card-content>
                        <div class="tip-header">
                            <mat-icon color="primary">water_drop</mat-icon>
                            <h4>Riega tus plantas al amanecer</h4>
                        </div>
                        <p>Evita la evaporación rápida y mejora la absorción del agua.</p>
                    </mat-card-content>
                </mat-card>
                
                <mat-card class="tip-item">
                    <mat-card-content>
                        <div class="tip-header">
                            <mat-icon color="accent">compost</mat-icon>
                            <h4>Utiliza compost orgánico regularmente</h4>
                        </div>
                        <p>Enriquece el suelo con nutrientes esenciales sin químicos.</p>
                    </mat-card-content>
                </mat-card>
                
                <mat-card class="tip-item">
                    <mat-card-content>
                        <div class="tip-header">
                            <mat-icon color="primary">yard</mat-icon>
                            <h4>Asocia cultivos compatibles</h4>
                        </div>
                        <p>Plantar albahaca junto a tomates repele plagas de forma natural.</p>
                    </mat-card-content>
                </mat-card>
            </div>
        </mat-card-content>
    </mat-card>
</div>
